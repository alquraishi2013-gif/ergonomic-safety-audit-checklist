<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ù†Ø³Ø®Ø© Ø§Ù„Ù…ØµÙ…Ù… â€“ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨Ø§Ø¨ ÙˆØ¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</title>
<style>
  :root{--bg:#f7f8fb;--ink:#111;--muted:#666;--line:#e5e7eb;--card:#fff;--accent:#2563eb;--head:#e6f0ff}
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font-family:"Noto Kufi Arabic","Cairo",Tahoma,Arial,sans-serif}
  .wrap{max-width:1100px;margin:auto;padding:18px}
  .card{background:var(--card);border:1px solid #d9dde5;border-radius:14px;padding:18px;box-shadow:0 2px 10px rgba(0,0,0,.04)}
  .title{display:flex;align-items:center;gap:12px}
  .title h1{margin:0;font-size:20px}
  .logo{height:64px;object-fit:contain}
  .muted{color:var(--muted);font-size:13px}
  .row{display:grid;gap:10px}
  @media(min-width:768px){.row{grid-template-columns:repeat(12,1fr)}.col-3{grid-column:span 3}.col-4{grid-column:span 4}.col-6{grid-column:span 6}.col-8{grid-column:span 8}.col-12{grid-column:span 12}}
  input[type=text],input[type=date],input[type=search],input[type=number],select{width:100%;padding:10px;border:1px solid var(--line);border-radius:10px;background:#fff}
  table{width:100%;border-collapse:collapse;margin-top:10px}
  th,td{border:1px solid #cfd7e3;padding:8px;vertical-align:middle}
  th{background:var(--head);text-align:center}
  td.num{width:54px;text-align:center}
  td[contenteditable]{outline:0;min-height:28px}
  .toolbar{display:flex;flex-wrap:wrap;gap:8px;margin:12px 0}
  .btn{padding:10px 14px;border-radius:10px;border:1px solid #d0d7ff;background:#fff;cursor:pointer}
  .btn.primary{background:var(--accent);color:#fff;border-color:var(--accent)}
  .pill{display:inline-block;padding:2px 8px;border-radius:999px;background:#eef2ff;border:1px solid #c7d2fe;font-size:.8rem;color:#374151}
  .hidden{display:none!important}
  .box{border:1px dashed #cfd7e3;border-radius:10px;padding:10px;margin:8px 0}
  @media print{.no-print{display:none!important}.card{border:0;box-shadow:none}body{background:#fff}}
</style>
</head>
<body>
<div class="wrap">
  <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØµÙ…Ù… -->
  <section id="designer" class="card">
    <div class="title">
      <img id="lg" class="logo" alt="logo" hidden>
      <h1>Ù†Ø³Ø®Ø© Ø§Ù„Ù…ØµÙ…Ù… â€“ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨Ø§Ø¨ ÙˆØªØ­Ø¶ÙŠØ± Ù†Ø³Ø®Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„</h1>
      <span style="margin-inline-start:auto"></span>
      <button type="button" class="btn no-print" id="printSetup">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
    </div>
    <div class="muted">Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ§Ù„Ù…ÙˆÙ‚Ø¹ØŒ Ø§Ø®ØªØ± Ø§Ù„Ø¨Ø§Ø¨ ÙˆØ§Ù„Ù‚Ø§Ù„Ø¨ØŒ Ø¹Ø¯Ù‘Ù„ Ø§Ù„Ø¨Ù†ÙˆØ¯ØŒ Ø«Ù… Ø§Ø¶ØºØ· "Ù…Ø¹Ø§ÙŠÙ†Ø© Ù†Ø³Ø®Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„" Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±. ÙŠÙ…ÙƒÙ†Ùƒ Ø£ÙŠØ¶Ù‹Ø§ ØªØµØ¯ÙŠØ± HTML Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¹Ù…ÙŠÙ„.</div>
    <div id="toast" class="hidden" style="margin-top:8px;padding:8px 12px;border:1px solid #c7d2fe;background:#eef2ff;border-radius:10px;color:#374151"></div>

    <div class="row" style="margin-top:10px">
      <div class="col-4"><label>Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©<br><input id="dClient" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø´Ø±ÙƒØ© Ø§Ù„Ø®Ù„ÙŠØ¬"></label></div>
      <div class="col-4"><label>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹<br><input id="dSite" type="text" placeholder="Ù…Ø«Ø§Ù„: Ù…ØµÙ†Ø¹ Ø§Ù„Ø´Ø¹ÙŠØ¨Ø©"></label></div>
      <div class="col-4"><label>ÙˆØµÙ Ø§Ù„Ù…ÙˆÙ‚Ø¹<br>
        <div style="display:flex;gap:6px">
          <select id="dDescSel" style="flex:1">
            <option value="">â€” Ø§Ø®ØªØ± ÙˆØµÙÙ‹Ø§ â€”</option>
            <option>Ù…ÙƒØªØ¨</option>
            <option>ÙˆØ±Ø´Ø©</option>
            <option>Ù…ØµÙ†Ø¹</option>
            <option>Ù…Ø³ØªÙˆØ¯Ø¹</option>
            <option>Ù…ÙˆÙ‚Ø¹ Ø®Ø§Ø±Ø¬ÙŠ</option>
            <option value="__other">Ø£Ø®Ø±Ù‰â€¦</option>
          </select>
          <input id="dDescOther" type="text" placeholder="Ø§ÙƒØªØ¨ ÙˆØµÙÙ‹Ø§" class="hidden" style="flex:1">
        </div>
      </label></div>
      <div class="col-3"><label>Ø±Ù‚Ù… Ø§Ù„Ø¨Ø§Ø¨<br><input id="gateNo" type="text" placeholder="1"></label></div>
      <div class="col-5"><label>Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø¨<br><input id="gateName" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø¢Ù„Ø§Øª"></label></div>
      <div class="col-4"><label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±<br><input id="issueDate" type="date"></label></div>
      <div class="col-6"><label class="btn no-print" style="display:inline-flex;align-items:center;gap:8px"><input type="file" id="logoInput" accept="image/*"> Ø±ÙØ¹ Ø§Ù„Ø´Ø¹Ø§Ø±</label></div>
    </div>

    <div class="toolbar no-print">
      <span class="pill">ğŸ“š Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨ Ø§Ù„Ø³Ø±ÙŠØ¹Ø©:</span>
      <button type="button" class="btn" data-tpl="ch1">Ø¨Ø§Ø¨ 1</button>
      <button type="button" class="btn" data-tpl="ch2">Ø¨Ø§Ø¨ 2</button>
      <button type="button" class="btn" data-tpl="ch3">Ø¨Ø§Ø¨ 3</button>
      <button type="button" class="btn" data-tpl="ch4">Ø¨Ø§Ø¨ 4</button>
      <button type="button" class="btn" data-tpl="ch5">Ø¨Ø§Ø¨ 5</button>
      <button type="button" class="btn" data-tpl="ch6">Ø¨Ø§Ø¨ 6</button>
      <button type="button" class="btn" data-tpl="ch7">Ø¨Ø§Ø¨ 7</button>
      <button type="button" class="btn" data-tpl="ch8">Ø¨Ø§Ø¨ 8</button>
      <button type="button" class="btn" data-tpl="ergo">Ergonomic</button>
      <span style="flex:1"></span>
      <label class="pill"><input type="checkbox" id="optChecks" checked> âœ”/âœ–</label>
      <label class="pill"><input type="checkbox" id="optRisk"> ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø± (1â€“5)</label>
    </div>

    <div class="toolbar no-print">
      <button type="button" class="btn" id="addRow">â• Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯</button>
      <button type="button" class="btn" id="selectAll">âœ”ï¸ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„</button>
      <button type="button" class="btn" id="clearAll">âŒ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ¯</button>
      <button type="button" class="btn" id="saveDraft">ğŸ’¾ Ø­ÙØ¸ Ù…Ø³ÙˆØ¯Ø©</button>
      <button type="button" class="btn" id="reset">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
      <span style="flex:1"></span>
      <input id="filter" type="search" placeholder="ÙÙ„ØªØ±Ø© Ø§Ù„Ø¨Ù†ÙˆØ¯â€¦" style="max-width:280px">
    </div>

    <table>
      <thead><tr><th style="width:74px">ØªØ¶Ù…ÙŠÙ†</th><th>Ù†Øµ Ø§Ù„Ø¨Ù†Ø¯</th></tr></thead>
      <tbody id="tbody"></tbody>
    </table>

    <div class="toolbar no-print">
      <button type="button" class="btn primary" id="preview">ğŸ‘ï¸ Ù…Ø¹Ø§ÙŠÙ†Ø© Ù†Ø³Ø®Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ (Ø§Ø®ØªØ¨Ø§Ø±)</button>
      <button type="button" class="btn" id="exportHtml">â¬‡ï¸ ØªØµØ¯ÙŠØ± HTML Ù„Ù„Ø¹Ù…ÙŠÙ„ (Ø£ÙˆÙÙ„Ø§ÙŠÙ†)</button>
    </div>
  </section>

  <!-- Ù…Ø¹Ø§ÙŠÙ†Ø©/Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø³Ø®Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ -->
  <section id="client" class="card hidden">
    <div class="title" style="justify-content:center">
      <img id="lg2" class="logo" alt="logo" hidden>
      <h1 id="titleTxt">Ù‚Ø§Ø¦Ù…Ø© ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø³Ù„Ø§Ù…Ø© â€“ Ø§Ù„Ø¨Ø§Ø¨</h1>
    </div>

    <div class="row">
      <div class="col-4"><label>Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©<br><input id="cClient" type="text"></label></div>
      <div class="col-4"><label>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹<br><input id="cSite" type="text"></label></div>
      <div class="col-4"><label>ÙˆØµÙ Ø§Ù„Ù…ÙˆÙ‚Ø¹<br><input id="cDesc" type="text" placeholder="Ù…ÙƒØªØ¨ / ÙˆØ±Ø´Ø© / â€¦"></label></div>
      <div class="col-4"><label>Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ù‚Ù‚<br><input id="cAuditor" type="text"></label></div>
      <div class="col-4"><label>Ø§Ù„ØªØ§Ø±ÙŠØ®<br><input id="cDate" type="date"></label></div>
    </div>

    <table id="clientTable">
      <thead>
        <tr>
          <th>Ù…</th><th>Ø§Ù„Ø¨Ù†Ø¯</th><th id="hOk">âœ“</th><th id="hNo">âœ—</th><th id="hRisk" class="hidden">Ø§Ù„Ù…Ø®Ø§Ø·Ø± (1â€“5)</th><th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª (â‰¤50)</th>
        </tr>
      </thead>
      <tbody id="clientBody"></tbody>
    </table>

    <div class="toolbar no-print">
      <button type="button" class="btn" id="back">â†©ï¸ Ø±Ø¬ÙˆØ¹ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„</button>
      <span style="flex:1"></span>
      <button type="button" class="btn" id="printClient">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
    </div>
  </section>
</div>

<script>
(function(){
  const $ = s=>document.querySelector(s);
  const S = s=>document.querySelectorAll(s);

  // Ø§Ù„Ø¹Ù†Ø§ØµØ±
  const els = {
    // Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØµÙ…Ù…
    designer: $('#designer'), client: $('#client'),
    lg: $('#lg'), lg2: $('#lg2'), logoInput: $('#logoInput'),
    dClient: $('#dClient'), dSite: $('#dSite'), dDescSel: $('#dDescSel'), dDescOther: $('#dDescOther'),
    gateNo: $('#gateNo'), gateName: $('#gateName'), issueDate: $('#issueDate'),
    optChecks: $('#optChecks'), optRisk: $('#optRisk'),
    addRow: $('#addRow'), selectAll: $('#selectAll'), clearAll: $('#clearAll'), saveDraft: $('#saveDraft'), reset: $('#reset'),
    filter: $('#filter'),
    tbody: $('#tbody'),
    preview: $('#preview'), exportHtml: $('#exportHtml'), printSetup: $('#printSetup'),
    // Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„
    titleTxt: $('#titleTxt'), cClient: $('#cClient'), cSite: $('#cSite'), cDesc: $('#cDesc'), cAuditor: $('#cAuditor'), cDate: $('#cDate'),
    clientBody: $('#clientBody'), hRisk: $('#hRisk'), back: $('#back'), printClient: $('#printClient')
  };

  // ØªØ§Ø±ÙŠØ® Ø§ÙØªØ±Ø§Ø¶ÙŠ
  const today = new Date().toISOString().slice(0,10);
  els.issueDate.value = today; els.cDate.value = today;

  // Ø§Ù„Ø­Ø§Ù„Ø©
  let logoData = '';
  let rows = []; // {id,text,include}

  // Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨
  function toast(msg){ const t=document.getElementById('toast'); if(!t) return; t.textContent=msg; t.classList.remove('hidden'); setTimeout(()=>t.classList.add('hidden'),1500); }
  function applyTemplate(key){
    const arr = templates[key]||[]; if(!arr.length){ alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ù†ÙˆØ¯ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø§Ø¨'); return; }
    const replace = confirm('Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¨Ø§Ù„Ù‚Ø§Ù„Ø¨ØŸ\nOK = Ø§Ø³ØªØ¨Ø¯Ø§Ù„\nCancel = Ø¥Ø¶Ø§ÙØ©');
    // Ø£Ø²Ù„ Ø£ÙŠ ÙÙ„ØªØ±Ø© Ø­ØªÙ‰ ØªØ¸Ù‡Ø± Ø§Ù„Ø¨Ù†ÙˆØ¯
    els.filter.value='';
    if(replace){ rows = []; }
    arr.forEach(t=> rows.push({id:uid(), text:t, include:true}));
    // Ø§Ø³Ù…/Ø±Ù‚Ù… Ø§Ù„Ø¨Ø§Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¥Ù† Ù„Ù… ÙŠÙÙ…Ù„Ø£Ø§
    if(!els.gateName.value){
  els.saveDraft.onclick=()=>{ persist(); alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ø³ÙˆØ¯Ø© Ù…Ø­Ù„ÙŠÙ‹Ø§'); };
  els.reset.onclick=()=>{ if(confirm('Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')){ localStorage.removeItem(LS_KEY); rows=[]; logoData=''; els.lg.hidden=true; renderSetup(); els.dClient.value=els.dSite.value=els.gateNo.value=els.gateName.value=''; els.dDescSel.value=''; els.dDescOther.value=''; } };
  els.printSetup.onclick=()=>window.print();

  // Ù…Ø¹Ø§ÙŠÙ†Ø© Ù†Ø³Ø®Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„
  els.preview.onclick=()=>{
    const list = rows.filter(r=>r.include && String(r.text||'').trim());
    if(!list.length) return alert('Ø§Ø®ØªØ± Ø¨Ù†Ø¯Ù‹Ø§ ÙˆØ§Ø­Ø¯Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
    els.titleTxt.textContent = `Ù‚Ø§Ø¦Ù…Ø© ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø³Ù„Ø§Ù…Ø© â€“ Ø§Ù„Ø¨Ø§Ø¨ ${els.gateNo.value||'-'} â€“ ${els.gateName.value||''}`;
    els.cClient.value = els.dClient.value; els.cSite.value = els.dSite.value;
    const desc = (els.dDescSel.value==='__other'? els.dDescOther.value : els.dDescSel.value) || '';
    els.cDesc.value = desc;
    $('#clientBody').innerHTML='';
    if(logoData){ els.lg2.src=logoData; els.lg2.hidden=false; } else { els.lg2.hidden=true; }

    const includeRisk = !!els.optRisk.checked; if(includeRisk){ els.hRisk.classList.remove('hidden'); } else { els.hRisk.classList.add('hidden'); }

    list.forEach((r,i)=>{
      const tr=document.createElement('tr');
      tr.innerHTML = `<td class="num">${i+1}</td>
                      <td>${escapeHtml(r.text)}</td>
                      ${els.optChecks.checked? `<td class="chk"><input type="checkbox" class="ok"></td><td class="chk"><input type="checkbox" class="no"></td>` : `<td class="chk">â€”</td><td class="chk">â€”</td>`}
                      ${includeRisk? `<td style="text-align:center"><select class="riskSel"><option value=""></option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select></td>` : ''}
                      <td><input type="text" maxlength="50" placeholder="Ø­ØªÙ‰ 50 Ø­Ø±ÙÙ‹Ø§"></td>`;
      $('#clientBody').appendChild(tr);
    });

    // ØªÙ†Ø§ÙÙŠ âœ“/âœ—
    $('#clientBody').querySelectorAll('tr').forEach(tr=>{
      const ok=tr.querySelector('.ok'), no=tr.querySelector('.no');
      if(ok && no){ ok.addEventListener('change',()=>{ if(ok.checked) no.checked=false; }); no.addEventListener('change',()=>{ if(no.checked) ok.checked=false; }); }
    });

    els.designer.classList.add('hidden'); els.client.classList.remove('hidden');
  };

  // ØªØµØ¯ÙŠØ± HTML Ù„Ù„Ø¹Ù…ÙŠÙ„ (Ø£ÙˆÙÙ„Ø§ÙŠÙ†)
  els.exportHtml.onclick=()=>{
    const list = rows.filter(r=>r.include && String(r.text||'').trim());
    if(!list.length) return alert('Ø§Ø®ØªØ± Ø¨Ù†Ø¯Ù‹Ø§ ÙˆØ§Ø­Ø¯Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
    const includeRisk = !!els.optRisk.checked; const includeChecks = !!els.optChecks.checked;
    const desc = (els.dDescSel.value==='__other'? els.dDescOther.value : els.dDescSel.value) || '';

    const rowsHtml = list.map((r,i)=>{
      const cells = [ `<td style="text-align:center">${i+1}</td>`, `<td>${escapeHtml(r.text)}</td>` ];
      if(includeChecks){ cells.push('<td style="text-align:center">â˜</td>','<td style="text-align:center">â˜</td>'); }
      if(includeRisk){ cells.push('<td style="text-align:center">&nbsp;</td>'); }
      cells.push('<td></td>');
      return `<tr>${cells.join('')}</tr>`;
    }).join('');

    const checksHdr = includeChecks? '<th>âœ“</th><th>âœ—</th>' : '';
    const riskHdr   = includeRisk? '<th>Ø§Ù„Ù…Ø®Ø§Ø·Ø± (1â€“5)</th>' : '';
    const logoHTML  = logoData? `<div style="text-align:center;margin-bottom:8px"><img src="${logoData}" style="height:60px;object-fit:contain"></div>`:'';

    const html = `<!doctype html><html lang="ar" dir="rtl"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Ù†Ø³Ø®Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„</title>
<style>body{font-family:Tahoma,Arial;margin:0;background:#f7f8fb;color:#111} .wrap{max-width:900px;margin:auto;padding:16px} .card{background:#fff;border:1px solid #ddd;border-radius:12px;padding:16px} h2{text-align:center;margin:.2rem 0 .6rem} table{width:100%;border-collapse:collapse;margin-top:10px} th,td{border:1px solid #ccc;padding:8px;vertical-align:middle} th{background:#e6f0ff;text-align:center}</style></head>
<body><div class="wrap"><div class="card">${logoHTML}
<h2>Ù‚Ø§Ø¦Ù…Ø© ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø³Ù„Ø§Ù…Ø© â€“ Ø§Ù„Ø¨Ø§Ø¨ ${escapeHtml(els.gateNo.value||'-')} â€“ ${escapeHtml(els.gateName.value||'')}</h2>
<div style="margin:6px 0 10px;color:#333">Ø§Ù„Ø´Ø±ÙƒØ©: ${escapeHtml(els.dClient.value||'-')} | Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${escapeHtml(els.dSite.value||'-')} | Ø§Ù„ÙˆØµÙ: ${escapeHtml(desc||'-')} | Ø§Ù„Ø¥ØµØ¯Ø§Ø±: ${escapeHtml(els.issueDate.value||'-')}</div>
<table><thead><tr><th>Ù…</th><th>Ø§Ù„Ø¨Ù†Ø¯</th>${checksHdr}${riskHdr}<th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th></tr></thead><tbody>${rowsHtml}</tbody></table>
</div></div></body></html>`;

    const blob=new Blob([html],{type:'text/html'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='Ù†Ø³Ø®Ø©-Ø§Ù„Ø¹Ù…ÙŠÙ„.html'; a.click(); URL.revokeObjectURL(url);
  };

  // Ø§Ù„Ø¹ÙˆØ¯Ø© Ù…Ù† Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
  els.back.onclick=()=>{ els.client.classList.add('hidden'); els.designer.classList.remove('hidden'); };
  els.printClient.onclick=()=>window.print();

  // ØªØ²Ø§Ù…Ù† Ù‚ÙŠÙ… Ø¹Ø§Ù…Ø©
  ['input','change'].forEach(ev=>{
    ['dClient','dSite','gateNo','gateName','issueDate','optChecks','optRisk'].forEach(id=>{ els[id].addEventListener(ev, persist); });
  });

  // Ø¨Ø¯Ø¡
  function seed(){ if(rows.length) return; ['Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¯Ù„ÙŠÙ„ Ø¥Ø±Ø´Ø§Ø¯ÙŠ Ù„Ù„Ø³Ù„Ø§Ù…Ø©','ØªØ­Ø¯ÙŠØ¯ Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø¹Ù…Ù„','ØªÙˆÙÙŠØ± Ù…Ø¹Ø¯Ø§Øª Ø§Ù„ÙˆÙ‚Ø§ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ©','ÙØ­Øµ Ù…Ø¹Ø¯Ø§Øª Ø§Ù„Ø¥Ø·ÙØ§Ø¡ ÙˆØµÙ„Ø§Ø­ÙŠØªÙ‡Ø§'].forEach(t=>addRow(t)); }
  restore(); seed();
})();
</script>
</body>
</html>
